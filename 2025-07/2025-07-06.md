---
tags:
  - 日記
  - PermanentNote
aliases: 
UID: 2025-07-05T21-40-18
---
掲示板作成機能の追加
全体の流れ
作成画面を作る
作成処理機能を実装する

作成画面の生成
ルーティング
resources :boards, only: %i[index new create]

newメソッドとcreateメソッドの追加

コントローラーとアクションの設定

def new
  @board = Board.new
end

```
def create
    @board = current_user.boards.build(board_params)
    if @board.save
      redirect_to boards_path, success: t('defaults.flash_message.created', item: Board.model_name.human)
    else
      flash.now[:danger] = t('defaults.flash_message.not_created', item: Board.model_name.human)
      render :new, status: :unprocessable_entity
    end
  end
```
```
@board = current_user.boards.build(board_params)
```

Boardテーブルには誰が掲示板を投稿したかの情報（user_id）が必要

アソシエーション＝モデル間の関連付け
userモデルのアソシエーション（has_many）によりcurrent_user.boardの記述によってログインしているユーザーが投稿した掲示板一覧を取得できる
そこからさらにbuildメソッドにつなげることで、ユーザーが投稿した掲示板一覧に新しくBoardのインスタンスを生成している
current_userはgem'sorcery'が用意しているメソッドで、ログイン中のUserモデルのインスタンスを呼び出せる

current_user.boards.buildでは、まだBoardテーブルに必要なカラムが含まれていない状態
その状態のオブジェクトにboard_paramsを渡してあげることで、board_paramsメソッドに記述されているフォームからの情報を一括代入し、それを@board変数に格納している

item: Board.model_name.human
i18nを用いてmodel boardを日本語にしている
この場合ja.ymlにboard: 掲示板と記述しているため、掲示板と表記される